{% extends "layout.html" %}
{% block content %}
<style>
    body {
        background-color: #f4f7f9;
    }
    .search-bar {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }
    .card {
        border: none;
        border-radius: 16px;
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }
    .card-title {
        color: #2c3e50;
    }
    .btn-outline-primary {
        border-radius: 20px;
        font-weight: 500;
    }
    .section-heading {
        color: #34495e;
    }
</style>

<h2 class="mb-4 section-heading text-center">🌟 Browse Public Profiles</h2>

<form method="GET" action="{{ url_for('main.public_profiles') }}" class="search-bar mb-5 row g-3 justify-content-center">
    <div class="col-md-4">
        <input type="text" class="form-control" name="skill" placeholder="🔍 Search by skill..." value="{{ request.args.get('skill', '') }}">
    </div>
    <div class="col-md-4">
        <select name="availability" class="form-select">
            <option value="">🗓️ Filter by availability</option>
            <option value="weekends" {% if request.args.get('availability') == 'weekends' %}selected{% endif %}>Weekends</option>
            <option value="evenings" {% if request.args.get('availability') == 'evenings' %}selected{% endif %}>Evenings</option>
            <option value="anytime" {% if request.args.get('availability') == 'anytime' %}selected{% endif %}>Anytime</option>
        </select>
    </div>
    <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">🔎 Search</button>
    </div>
</form>

<div class="row">
    {% for user in users %}
    <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
        <div class="card shadow-sm h-100 bg-white">
            <div class="card-body">
                <h5 class="card-title">{{ user.name }}</h5>
                <p class="card-text text-muted">
                    📍 <strong>Location:</strong> {{ user.location }}<br>
                    ⏰ <strong>Availability:</strong> {{ user.availability }}
                </p>

                <p class="mt-3 mb-1"><strong>🛠️ Skills Offered:</strong></p>
                <ul class="mb-2">
                    {% for skill in user.skills_offered %}
                        <li>{{ skill.name }}</li>
                    {% endfor %}
                </ul>

                <p class="mb-1"><strong>🎯 Skills Wanted:</strong></p>
                <ul class="mb-3">
                    {% for skill in user.skills_wanted %}
                        <li>{{ skill.name }}</li>
                    {% endfor %}
                </ul>

                {% if current_user.is_authenticated and current_user.id != user.id %}
                    <a href="{{ url_for('main.view_profile', user_id=user.id) }}" class="btn btn-outline-primary w-100">🤝 Request Swap</a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}
